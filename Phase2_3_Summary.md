# SRAIOT 复现第二、三阶段总结：网络仿真与路由构建

## 1. 目标回顾
第二阶段和第三阶段的目标是构建一个动态的 IoT 网络仿真环境，并实现论文提出的 SRAIOT 核心路由协议逻辑，包括子网聚类、控制器选举以及层次化路由树的构建。

## 2. 第二阶段：仿真基础环境实现
- **移动性建模**：在 `simulation/node.py` 中实现了 `IoTNode` 类，支持节点在 $500m \times 500m$ 区域内的随机移动（速度 $0-10m/s$）及边界反弹逻辑。
- **连接稳定性预测**：精确实现了论文核心公式 (1) 的 $T_{ij}$ 算法，用于预测两节点在 $\Delta t$ 时间内保持连接的概率。
- **邻居发现**：实现了基于 Hello 报文的发现机制，模拟 RSSI 信号强度交换，并动态维护邻居表。

## 3. 第三阶段：SRAIOT 路由协议实现
- **SDN 驱动聚类**：
  - 基于节点位置和 $T_{ij}$ 预测值进行子网划分。
  - **控制器竞选**：在每个簇内选举邻居度（Degree）最高的节点作为 SDN 控制器。
- **层次化拓扑构建**：
  - **中心节点选举**：选取全网邻居度最高的控制器作为拓扑中心 $C_t$（根节点）。
  - **链路权重计算**：实现了公式 (2) $W_{ij} = (C_j \times D_j) / E_j$，综合考虑了下游节点的拥塞程度、物理距离和剩余能量。
  - **最短路径树**：利用 Dijkstra 算法构建了从各子网控制器到 $C_t$ 的全局最优路由路径。

## 4. 自动化实验产出
- **日志系统**：自动记录每一步的节点存活、簇数量及控制器选举状态。
- **可视化能力**：自动生成 `.png` 格式的拓扑分布图，实时展示网络结构变化。
- **数据统计**：导出 `simulation_stats.csv`，为最终阶段的性能分析提供基础数据。

## 5. 结论
目前已成功搭建了支撑 SRAIOT 运行的底层网络架构。网络能够根据节点移动动态调整拓扑，并选取最优路径。这为第四阶段集成集成学习模型进行“攻击识别与防御”提供了完整的测试平台。

